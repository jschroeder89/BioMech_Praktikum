<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ChibiOS/NIL: Heaps</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ChibiOS/NIL
   &#160;<span id="projectnumber">2.0.4</span>
<script type="text/javascript"><!--
google_ad_client = "pub-3840594581853944";
/* Documentation, bottom, 728x90, created 9/19/10 */
google_ad_slot = "1902290615";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__heaps.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Heaps</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Heap Allocator related APIs. </p><h2>Operation mode</h2>
<p>The heap allocator implements a first-fit strategy and its APIs are functionally equivalent to the usual <code>malloc()</code> and <code>free()</code> library functions. The main difference is that the OS heap APIs are guaranteed to be thread safe and there is the ability to return memory blocks aligned to arbitrary powers of two.<br />
 </p><dl class="section pre"><dt>Precondition</dt><dd>In order to use the heap APIs the <code>CH_CFG_USE_HEAP</code> option must be enabled in <code><a class="el" href="chconf_8h.html" title="Configuration file template. ">chconf.h</a></code>. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Compatible with RT and NIL. </dd></dl>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gac6979e17fe1a68c68d0f25a4862168fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a>&#160;&#160;&#160;8U</td></tr>
<tr class="memdesc:gac6979e17fe1a68c68d0f25a4862168fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum alignment used for heap.  <a href="#gac6979e17fe1a68c68d0f25a4862168fa">More...</a><br /></td></tr>
<tr class="separator:gac6979e17fe1a68c68d0f25a4862168fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad1e3b3c40c81275c2d0e15f8a1ce1616"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#gad1e3b3c40c81275c2d0e15f8a1ce1616">CH_HEAP_AREA</a>(name,  size)</td></tr>
<tr class="memdesc:gad1e3b3c40c81275c2d0e15f8a1ce1616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocation of an aligned static heap buffer.  <a href="#gad1e3b3c40c81275c2d0e15f8a1ce1616">More...</a><br /></td></tr>
<tr class="separator:gad1e3b3c40c81275c2d0e15f8a1ce1616"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga600f63c84afa49b1f65f6770ba1904c8"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structmemory__heap.html">memory_heap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a></td></tr>
<tr class="memdesc:ga600f63c84afa49b1f65f6770ba1904c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of a memory heap.  <a href="#ga600f63c84afa49b1f65f6770ba1904c8">More...</a><br /></td></tr>
<tr class="separator:ga600f63c84afa49b1f65f6770ba1904c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac623f8602f49ad15b517071330a262d0"><td class="memItemLeft" align="right" valign="top">typedef union <a class="el" href="unionheap__header.html">heap_header</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#gac623f8602f49ad15b517071330a262d0">heap_header_t</a></td></tr>
<tr class="memdesc:gac623f8602f49ad15b517071330a262d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Type of a memory heap header.  <a href="#gac623f8602f49ad15b517071330a262d0">More...</a><br /></td></tr>
<tr class="separator:gac623f8602f49ad15b517071330a262d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unionheap__header.html">heap_header</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Memory heap block header.  <a href="unionheap__header.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmemory__heap.html">memory_heap</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure describing a memory heap.  <a href="structmemory__heap.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga777708769d35996ed5f0d8bd4642217c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#ga777708769d35996ed5f0d8bd4642217c">_heap_init</a> (void)</td></tr>
<tr class="memdesc:ga777708769d35996ed5f0d8bd4642217c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the default heap.  <a href="#ga777708769d35996ed5f0d8bd4642217c">More...</a><br /></td></tr>
<tr class="separator:ga777708769d35996ed5f0d8bd4642217c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39b00c3aeea2e08e160f6018124b6001"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#ga39b00c3aeea2e08e160f6018124b6001">chHeapObjectInit</a> (<a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> *heapp, void *buf, size_t size)</td></tr>
<tr class="memdesc:ga39b00c3aeea2e08e160f6018124b6001"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a memory heap from a static memory area.  <a href="#ga39b00c3aeea2e08e160f6018124b6001">More...</a><br /></td></tr>
<tr class="separator:ga39b00c3aeea2e08e160f6018124b6001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab98ee301308d5faeb08d79ac591d791a"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#gab98ee301308d5faeb08d79ac591d791a">chHeapAllocAligned</a> (<a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> *heapp, size_t size, unsigned align)</td></tr>
<tr class="memdesc:gab98ee301308d5faeb08d79ac591d791a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a block of memory from the heap by using the first-fit algorithm.  <a href="#gab98ee301308d5faeb08d79ac591d791a">More...</a><br /></td></tr>
<tr class="separator:gab98ee301308d5faeb08d79ac591d791a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0fc553df0138f02e0b233be91e413c79"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#ga0fc553df0138f02e0b233be91e413c79">chHeapFree</a> (void *p)</td></tr>
<tr class="memdesc:ga0fc553df0138f02e0b233be91e413c79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees a previously allocated memory block.  <a href="#ga0fc553df0138f02e0b233be91e413c79">More...</a><br /></td></tr>
<tr class="separator:ga0fc553df0138f02e0b233be91e413c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga95c3264f76916d9f7103a054e8b71e6d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#ga95c3264f76916d9f7103a054e8b71e6d">chHeapStatus</a> (<a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> *heapp, size_t *totalp, size_t *largestp)</td></tr>
<tr class="memdesc:ga95c3264f76916d9f7103a054e8b71e6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reports the heap status.  <a href="#ga95c3264f76916d9f7103a054e8b71e6d">More...</a><br /></td></tr>
<tr class="separator:ga95c3264f76916d9f7103a054e8b71e6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacdef5ac922b68f5234e8403b2aa2af0f"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#gacdef5ac922b68f5234e8403b2aa2af0f">chHeapAlloc</a> (<a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> *heapp, size_t size)</td></tr>
<tr class="memdesc:gacdef5ac922b68f5234e8403b2aa2af0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a block of memory from the heap by using the first-fit algorithm.  <a href="#gacdef5ac922b68f5234e8403b2aa2af0f">More...</a><br /></td></tr>
<tr class="separator:gacdef5ac922b68f5234e8403b2aa2af0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga01b6cbd7b2608d48bf2e81abe5a72520"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#ga01b6cbd7b2608d48bf2e81abe5a72520">chHeapGetSize</a> (const void *p)</td></tr>
<tr class="memdesc:ga01b6cbd7b2608d48bf2e81abe5a72520"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the size of an allocated block.  <a href="#ga01b6cbd7b2608d48bf2e81abe5a72520">More...</a><br /></td></tr>
<tr class="separator:ga01b6cbd7b2608d48bf2e81abe5a72520"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gaacd0d1c9e9b1769f69a4e56f5ac07716"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__heaps.html#gaacd0d1c9e9b1769f69a4e56f5ac07716">default_heap</a></td></tr>
<tr class="memdesc:gaacd0d1c9e9b1769f69a4e56f5ac07716"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default heap descriptor.  <a href="#gaacd0d1c9e9b1769f69a4e56f5ac07716">More...</a><br /></td></tr>
<tr class="separator:gaacd0d1c9e9b1769f69a4e56f5ac07716"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="gac6979e17fe1a68c68d0f25a4862168fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CH_HEAP_ALIGNMENT&#160;&#160;&#160;8U</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimum alignment used for heap. </p>
<dl class="section note"><dt>Note</dt><dd>Cannot use the sizeof operator in this macro. </dd></dl>

<p>Definition at line <a class="el" href="chheap_8h_source.html#l00042">42</a> of file <a class="el" href="chheap_8h_source.html">chheap.h</a>.</p>

<p>Referenced by <a class="el" href="group__heaps.html#gacdef5ac922b68f5234e8403b2aa2af0f">chHeapAlloc()</a>, <a class="el" href="group__heaps.html#gab98ee301308d5faeb08d79ac591d791a">chHeapAllocAligned()</a>, <a class="el" href="group__heaps.html#ga0fc553df0138f02e0b233be91e413c79">chHeapFree()</a>, <a class="el" href="group__heaps.html#ga39b00c3aeea2e08e160f6018124b6001">chHeapObjectInit()</a>, and <a class="el" href="group__heaps.html#ga95c3264f76916d9f7103a054e8b71e6d">chHeapStatus()</a>.</p>

</div>
</div>
<a class="anchor" id="gad1e3b3c40c81275c2d0e15f8a1ce1616"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CH_HEAP_AREA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">ALIGNED_VAR(<a class="code" href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a>)                                            \</div><div class="line">  uint8_t name[<a class="code" href="group___n_i_l___k_e_r_n_e_l.html#ga42e3518a4fa77a9ba316ddb019761fa3">MEM_ALIGN_NEXT</a>((size), <a class="code" href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a>)]</div><div class="ttc" id="group__heaps_html_gac6979e17fe1a68c68d0f25a4862168fa"><div class="ttname"><a href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a></div><div class="ttdeci">#define CH_HEAP_ALIGNMENT</div><div class="ttdoc">Minimum alignment used for heap. </div><div class="ttdef"><b>Definition:</b> <a href="chheap_8h_source.html#l00042">chheap.h:42</a></div></div>
<div class="ttc" id="group___n_i_l___k_e_r_n_e_l_html_ga42e3518a4fa77a9ba316ddb019761fa3"><div class="ttname"><a href="group___n_i_l___k_e_r_n_e_l.html#ga42e3518a4fa77a9ba316ddb019761fa3">MEM_ALIGN_NEXT</a></div><div class="ttdeci">#define MEM_ALIGN_NEXT(p, a)</div><div class="ttdoc">Aligns to the new aligned memory address. </div><div class="ttdef"><b>Definition:</b> <a href="ch_8h_source.html#l00685">ch.h:685</a></div></div>
</div><!-- fragment -->
<p>Allocation of an aligned static heap buffer. </p>

<p>Definition at line <a class="el" href="chheap_8h_source.html#l00114">114</a> of file <a class="el" href="chheap_8h_source.html">chheap.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga600f63c84afa49b1f65f6770ba1904c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structmemory__heap.html">memory_heap</a> <a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of a memory heap. </p>

<p>Definition at line <a class="el" href="chheap_8h_source.html#l00072">72</a> of file <a class="el" href="chheap_8h_source.html">chheap.h</a>.</p>

</div>
</div>
<a class="anchor" id="gac623f8602f49ad15b517071330a262d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef union <a class="el" href="unionheap__header.html">heap_header</a> <a class="el" href="group__heaps.html#gac623f8602f49ad15b517071330a262d0">heap_header_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Type of a memory heap header. </p>

<p>Definition at line <a class="el" href="chheap_8h_source.html#l00077">77</a> of file <a class="el" href="chheap_8h_source.html">chheap.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga777708769d35996ed5f0d8bd4642217c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _heap_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the default heap. </p>
<dl class="section user"><dt>Function Class:</dt><dd>Not an API, this function is for internal use only. </dd></dl>

<p>Definition at line <a class="el" href="chheap_8c_source.html#l00107">107</a> of file <a class="el" href="chheap_8c_source.html">chheap.c</a>.</p>

<p>References <a class="el" href="group__memcore.html#ga111b8298de9f8671842c79b29bd5d28f">chCoreAllocAlignedWithOffset()</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#gaf42abbc89cb3b2f4885717fd5096f954">chSemObjectInit</a>, <a class="el" href="structmemory__heap.html#a8f9579ccfb77165665cdb335b3569cd9">memory_heap::header</a>, <a class="el" href="structmemory__heap.html#a6af8f8905078744d1f1bd42c9108b08b">memory_heap::mtx</a>, and <a class="el" href="structmemory__heap.html#a35f2f01427198757a987ce012e135353">memory_heap::provider</a>.</p>

<p>Referenced by <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#gafe2c7de6567e98e487e009e81e3be10b">chSysInit()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__heaps_ga777708769d35996ed5f0d8bd4642217c_cgraph.png" border="0" usemap="#group__heaps_ga777708769d35996ed5f0d8bd4642217c_cgraph" alt=""/></div>
<map name="group__heaps_ga777708769d35996ed5f0d8bd4642217c_cgraph" id="group__heaps_ga777708769d35996ed5f0d8bd4642217c_cgraph">
<area shape="rect" id="node2" href="group__memcore.html#ga111b8298de9f8671842c79b29bd5d28f" title="Allocates a memory block. " alt="" coords="124,5,287,29"/>
<area shape="rect" id="node3" href="group__memcore.html#ga935cfedceae960e8e07fd8e0bfd189b1" title="Allocates a memory block. " alt="" coords="335,5,501,29"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga39b00c3aeea2e08e160f6018124b6001"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chHeapObjectInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> *&#160;</td>
          <td class="paramname"><em>heapp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a memory heap from a static memory area. </p>
<dl class="section note"><dt>Note</dt><dd>The heap buffer base and size are adjusted if the passed buffer is not aligned to <code>CH_HEAP_ALIGNMENT</code>. This mean that the effective heap size can be less than <code>size</code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">heapp</td><td>pointer to the memory heap descriptor to be initialized </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>heap buffer base </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>heap size</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Initializer, this function just initializes an object and can be invoked before the kernel is initialized. </dd></dl>

<p>Definition at line <a class="el" href="chheap_8c_source.html#l00131">131</a> of file <a class="el" href="chheap_8c_source.html">chheap.c</a>.</p>

<p>References <a class="el" href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga3d40b3669f5280264c24dae4a2565ff2">chDbgCheck</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#gaf42abbc89cb3b2f4885717fd5096f954">chSemObjectInit</a>, <a class="el" href="structmemory__heap.html#a8f9579ccfb77165665cdb335b3569cd9">memory_heap::header</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga42e3518a4fa77a9ba316ddb019761fa3">MEM_ALIGN_NEXT</a>, <a class="el" href="structmemory__heap.html#a6af8f8905078744d1f1bd42c9108b08b">memory_heap::mtx</a>, and <a class="el" href="structmemory__heap.html#a35f2f01427198757a987ce012e135353">memory_heap::provider</a>.</p>

</div>
</div>
<a class="anchor" id="gab98ee301308d5faeb08d79ac591d791a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * chHeapAllocAligned </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> *&#160;</td>
          <td class="paramname"><em>heapp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>align</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a block of memory from the heap by using the first-fit algorithm. </p>
<p>The allocated block is guaranteed to be properly aligned to the specified alignment.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">heapp</td><td>pointer to a heap descriptor or <code>NULL</code> in order to access the default heap. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>the size of the block to be allocated. Note that the allocated block may be a bit bigger than the requested size for alignment and fragmentation reasons. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">align</td><td>desired memory alignment </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the aligned allocated block. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>if the block cannot be allocated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="chheap_8c_source.html#l00170">170</a> of file <a class="el" href="chheap_8c_source.html">chheap.c</a>.</p>

<p>References <a class="el" href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga3d40b3669f5280264c24dae4a2565ff2">chDbgCheck</a>, <a class="el" href="group__heaps.html#gaacd0d1c9e9b1769f69a4e56f5ac07716">default_heap</a>, <a class="el" href="structmemory__heap.html#a8f9579ccfb77165665cdb335b3569cd9">memory_heap::header</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga42e3518a4fa77a9ba316ddb019761fa3">MEM_ALIGN_NEXT</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga2943ae986fb71c96a4f23cef20b63f25">MEM_IS_VALID_ALIGNMENT</a>, and <a class="el" href="structmemory__heap.html#a35f2f01427198757a987ce012e135353">memory_heap::provider</a>.</p>

<p>Referenced by <a class="el" href="group__heaps.html#gacdef5ac922b68f5234e8403b2aa2af0f">chHeapAlloc()</a>.</p>

</div>
</div>
<a class="anchor" id="ga0fc553df0138f02e0b233be91e413c79"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chHeapFree </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees a previously allocated memory block. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>pointer to the memory block to be freed</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="chheap_8c_source.html#l00291">291</a> of file <a class="el" href="chheap_8c_source.html">chheap.c</a>.</p>

<p>References <a class="el" href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga05556bc6888b5ff5ec4edcaf4830addc">chDbgAssert</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga3d40b3669f5280264c24dae4a2565ff2">chDbgCheck</a>, <a class="el" href="structmemory__heap.html#a8f9579ccfb77165665cdb335b3569cd9">memory_heap::header</a>, <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga42e3518a4fa77a9ba316ddb019761fa3">MEM_ALIGN_NEXT</a>, and <a class="el" href="group___n_i_l___k_e_r_n_e_l.html#ga3f9b6677f6c45fab69717f45a139c622">MEM_IS_ALIGNED</a>.</p>

</div>
</div>
<a class="anchor" id="ga95c3264f76916d9f7103a054e8b71e6d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t chHeapStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> *&#160;</td>
          <td class="paramname"><em>heapp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>totalp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>largestp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reports the heap status. </p>
<dl class="section note"><dt>Note</dt><dd>This function is meant to be used in the test suite, it should not be really useful for the application code.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">heapp</td><td>pointer to a heap descriptor or <code>NULL</code> in order to access the default heap. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalp</td><td>pointer to a variable that will receive the total fragmented free space or @ NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">largestp</td><td>pointer to a variable that will receive the largest free free block found space or @ NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of fragments in the heap.</dd></dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="chheap_8c_source.html#l00355">355</a> of file <a class="el" href="chheap_8c_source.html">chheap.c</a>.</p>

<p>References <a class="el" href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a>, <a class="el" href="group__heaps.html#gaacd0d1c9e9b1769f69a4e56f5ac07716">default_heap</a>, and <a class="el" href="structmemory__heap.html#a8f9579ccfb77165665cdb335b3569cd9">memory_heap::header</a>.</p>

</div>
</div>
<a class="anchor" id="gacdef5ac922b68f5234e8403b2aa2af0f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void* chHeapAlloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> *&#160;</td>
          <td class="paramname"><em>heapp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocates a block of memory from the heap by using the first-fit algorithm. </p>
<p>The allocated block is guaranteed to be properly aligned for a pointer data type.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">heapp</td><td>pointer to a heap descriptor or <code>NULL</code> in order to access the default heap. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>the size of the block to be allocated. Note that the allocated block may be a bit bigger than the requested size for alignment and fragmentation reasons. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the allocated block. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>if the block cannot be allocated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="chheap_8h_source.html#l00154">154</a> of file <a class="el" href="chheap_8h_source.html">chheap.h</a>.</p>

<p>References <a class="el" href="group__heaps.html#gac6979e17fe1a68c68d0f25a4862168fa">CH_HEAP_ALIGNMENT</a>, and <a class="el" href="group__heaps.html#gab98ee301308d5faeb08d79ac591d791a">chHeapAllocAligned()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__heaps_gacdef5ac922b68f5234e8403b2aa2af0f_cgraph.png" border="0" usemap="#group__heaps_gacdef5ac922b68f5234e8403b2aa2af0f_cgraph" alt=""/></div>
<map name="group__heaps_gacdef5ac922b68f5234e8403b2aa2af0f_cgraph" id="group__heaps_gacdef5ac922b68f5234e8403b2aa2af0f_cgraph">
<area shape="rect" id="node2" href="group__heaps.html#gab98ee301308d5faeb08d79ac591d791a" title="Allocates a block of memory from the heap by using the first&#45;fit algorithm. " alt="" coords="135,5,251,29"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ga01b6cbd7b2608d48bf2e81abe5a72520"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t chHeapGetSize </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the size of an allocated block. </p>
<dl class="section note"><dt>Note</dt><dd>The returned value is the requested size, the real size is the same value aligned to the next <code>CH_HEAP_ALIGNMENT</code> multiple.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>pointer to the memory block </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Size of the block.</dd></dl>
<dl class="section user"><dt>Function Class:</dt><dd>Normal API, this function can be invoked by regular system threads but not from within a lock zone. </dd></dl>

<p>Definition at line <a class="el" href="chheap_8h_source.html#l00169">169</a> of file <a class="el" href="chheap_8h_source.html">chheap.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="gaacd0d1c9e9b1769f69a4e56f5ac07716"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__heaps.html#ga600f63c84afa49b1f65f6770ba1904c8">memory_heap_t</a> default_heap</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default heap descriptor. </p>

<p>Definition at line <a class="el" href="chheap_8c_source.html#l00092">92</a> of file <a class="el" href="chheap_8c_source.html">chheap.c</a>.</p>

<p>Referenced by <a class="el" href="group__heaps.html#gab98ee301308d5faeb08d79ac591d791a">chHeapAllocAligned()</a>, and <a class="el" href="group__heaps.html#ga95c3264f76916d9f7103a054e8b71e6d">chHeapStatus()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Apr 17 2018 16:17:19 for ChibiOS/NIL by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
